function dN = dshape_hexa20(xi)
%
% function dN = dshape_hexa20(xi)
%
%    Twenty node hexhedral element
%
%   4----11---3  20--------19   8---15----7
%   !         !   !         !   !         !
%  12   t=-1  10  !   t=0   !  16   t=1   14 
%   !         !   !         !   !         !
%   1----9----2  17--------18   5---13----6
%

r = xi(1); s = xi(2); t = xi(3);

dN(1,1) = 0.125*(r + s + t + 2)*(s - 1)*(t - 1) + 0.125*(r - 1)*(s - 1)*(t - 1);
dN(1,2) = 0.125*(r + s + t + 2)*(r - 1)*(t - 1) + 0.125*(r - 1)*(s - 1)*(t - 1);
dN(1,3) = 0.125*(r + s + t + 2)*(r - 1)*(s - 1) + 0.125*(r - 1)*(s - 1)*(t - 1);
dN(2,1) = 0.125*(r - s - t - 2)*(s - 1)*(t - 1) + 0.125*(r + 1)*(s - 1)*(t - 1);
dN(2,2) = 0.125*(r - s - t - 2)*(r + 1)*(t - 1) - 0.125*(r + 1)*(s - 1)*(t - 1);
dN(2,3) = 0.125*(r - s - t - 2)*(r + 1)*(s - 1) - 0.125*(r + 1)*(s - 1)*(t - 1);
dN(3,1) = -0.125*(r + s - t - 2)*(s + 1)*(t - 1) - 0.125*(r + 1)*(s + 1)*(t - 1);
dN(3,2) = -0.125*(r + s - t - 2)*(r + 1)*(t - 1) - 0.125*(r + 1)*(s + 1)*(t - 1);
dN(3,3) = -0.125*(r + s - t - 2)*(r + 1)*(s + 1) + 0.125*(r + 1)*(s + 1)*(t - 1);
dN(4,1) = -0.125*(r - s + t + 2)*(s + 1)*(t - 1) - 0.125*(r - 1)*(s + 1)*(t - 1);
dN(4,2) = -0.125*(r - s + t + 2)*(r - 1)*(t - 1) + 0.125*(r - 1)*(s + 1)*(t - 1);
dN(4,3) = -0.125*(r - s + t + 2)*(r - 1)*(s + 1) - 0.125*(r - 1)*(s + 1)*(t - 1);
dN(5,1) = -0.125*(r + s - t + 2)*(s - 1)*(t + 1) - 0.125*(r - 1)*(s - 1)*(t + 1);
dN(5,2) = -0.125*(r + s - t + 2)*(r - 1)*(t + 1) - 0.125*(r - 1)*(s - 1)*(t + 1);
dN(5,3) = -0.125*(r + s - t + 2)*(r - 1)*(s - 1) + 0.125*(r - 1)*(s - 1)*(t + 1);
dN(6,1) = -0.125*(r - s + t - 2)*(s - 1)*(t + 1) - 0.125*(r + 1)*(s - 1)*(t + 1);
dN(6,2) = -0.125*(r - s + t - 2)*(r + 1)*(t + 1) + 0.125*(r + 1)*(s - 1)*(t + 1);
dN(6,3) = -0.125*(r - s + t - 2)*(r + 1)*(s - 1) - 0.125*(r + 1)*(s - 1)*(t + 1);
dN(7,1) = 0.125*(r + s + t - 2)*(s + 1)*(t + 1) + 0.125*(r + 1)*(s + 1)*(t + 1);
dN(7,2) = 0.125*(r + s + t - 2)*(r + 1)*(t + 1) + 0.125*(r + 1)*(s + 1)*(t + 1);
dN(7,3) = 0.125*(r + s + t - 2)*(r + 1)*(s + 1) + 0.125*(r + 1)*(s + 1)*(t + 1);
dN(8,1) = 0.125*(r - s - t + 2)*(s + 1)*(t + 1) + 0.125*(r - 1)*(s + 1)*(t + 1);
dN(8,2) = 0.125*(r - s - t + 2)*(r - 1)*(t + 1) - 0.125*(r - 1)*(s + 1)*(t + 1);
dN(8,3) = 0.125*(r - s - t + 2)*(r - 1)*(s + 1) - 0.125*(r - 1)*(s + 1)*(t + 1);
dN(9,1) = -0.5*r*(s - 1)*(t - 1);
dN(9,2) = -0.25*(r^2 - 1)*(t - 1);
dN(9,3) = -0.25*(r^2 - 1)*(s - 1);
dN(10,1) = 0.25*(s^2 - 1)*(t - 1);
dN(10,2) = 0.5*(r + 1)*s*(t - 1);
dN(10,3) = 0.25*(s^2 - 1)*(r + 1);
dN(11,1) = 0.5*r*(s + 1)*(t - 1);
dN(11,2) = 0.25*(r^2 - 1)*(t - 1);
dN(11,3) = 0.25*(r^2 - 1)*(s + 1);
dN(12,1) = -0.25*(s^2 - 1)*(t - 1);
dN(12,2) = -0.5*(r - 1)*s*(t - 1);
dN(12,3) = -0.25*(s^2 - 1)*(r - 1);
dN(13,1) = 0.5*r*(s - 1)*(t + 1);
dN(13,2) = 0.25*(r^2 - 1)*(t + 1);
dN(13,3) = 0.25*(r^2 - 1)*(s - 1);
dN(14,1) = -0.25*(s^2 - 1)*(t + 1);
dN(14,2) = -0.5*(r + 1)*s*(t + 1);
dN(14,3) = -0.25*(s^2 - 1)*(r + 1);
dN(15,1) = -0.5*r*(s + 1)*(t + 1);
dN(15,2) = -0.25*(r^2 - 1)*(t + 1);
dN(15,3) = -0.25*(r^2 - 1)*(s + 1);
dN(16,1) = 0.25*(s^2 - 1)*(t + 1);
dN(16,2) = 0.5*(r - 1)*s*(t + 1);
dN(16,3) = 0.25*(s^2 - 1)*(r - 1);
dN(17,1) = -0.25*(t^2 - 1)*(s - 1);
dN(17,2) = -0.25*(t^2 - 1)*(r - 1);
dN(17,3) = -0.5*(r - 1)*(s - 1)*t;
dN(18,1) = 0.25*(t^2 - 1)*(s - 1);
dN(18,2) = 0.25*(t^2 - 1)*(r + 1);
dN(18,3) = 0.5*(r + 1)*(s - 1)*t;
dN(19,1) = -0.25*(t^2 - 1)*(s + 1);
dN(19,2) = -0.25*(t^2 - 1)*(r + 1);
dN(19,3) = -0.5*(r + 1)*(s + 1)*t;
dN(20,1) = 0.25*(t^2 - 1)*(s + 1);
dN(20,2) = 0.25*(t^2 - 1)*(r - 1);
dN(20,3) = 0.5*(r - 1)*(s + 1)*t;
