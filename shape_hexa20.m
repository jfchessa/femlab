function N=shape_hexa20(xi)
%
% function N=shape_hexa20(xi)
%
%    Twenty node hexhedral element
%
%   4----11---3  20--------19   8---15----7
%   !         !   !         !   !         !
%  12   t=-1  10  !   t=0   !  16   t=1   14 
%   !         !   !         !   !         !
%   1----9----2  17--------18   5---13----6
%

r = xi(1); s = xi(2); t = xi(3);

N(1)  = -0.125*(1-r)*(1-s)*(1-t)*(2+r+s+t);
N(2)  =  0.125*(1+r)*(1-s)*(1-t)*(r-s-t-2);
N(3)  =  0.125*(1+r)*(1+s)*(1-t)*(r+s-t-2);
N(4)  =  0.125*(1-r)*(s+1)*(1-t)*(-r+s-t-2);
N(5)  =  0.125*(1-r)*(1-s)*(1+t)*(-r-s+t-2);
N(6)  =  0.125*(1+r)*(1-s)*(1+t)*(r-s+t-2);
N(7)  =  0.125*(1+r)*(1+s)*(1+t)*(r+s+t-2);
N(8)  =  0.125*(1-r)*(1+s)*(1+t)*(-r+s+t-2);
N(9)  =  0.25*(1-r^2)*(1-s)*(1-t);
N(10) =  0.25*(1+r)*(1-s^2)*(1-t);
N(11) =  0.25*(1-r^2)*(1+s)*(1-t);
N(12) =  0.25*(1-r)*(1-s^2)*(1-t);
N(13) =  0.25*(1-r^2)*(1-s)*(1+t);
N(14) =  0.25*(1+r)*(1-s^2)*(1+t);
N(15) =  0.25*(1-r^2)*(1+s)*(1+t);
N(16) =  0.25*(1-r)*(1-s^2)*(1+t);
N(17) =  0.25*(1-r)*(1-s)*(1-t^2);
N(18) =  0.25*(1+r)*(1-s)*(1-t^2);
N(19) =  0.25*(1+r)*(1+s)*(1-t^2);
N(20) =  0.25*(1-r)*(1+s)*(1-t^2);
